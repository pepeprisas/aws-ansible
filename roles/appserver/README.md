Role Name
=========

appserver role installs and configures Appserver software along tecnologies that are needed to serve the REST API.
All software is serve by Docker image that are stored in AWS registry.
This role can be applied into your local laptop or in a remote server.

Requirements
------------

This role is idempotent and it contains all its requirements.

Role Variables
--------------

###############
#  APPSERVER  #
###############
~~~
appserver_vars:
  APPSERVER_HOST                          : 0.0.0.0
  APPSERVER_PORT                          : 4443
  APPSERVER_HTTPS                         : True
  APPSERVER_VALIDATE_RESPONSES            : True
  APPSERVER_LOG_LEVEL                     : INFO
  APPSERVER_APP_MODE                      : dev
  APPSERVER_BACKEND                       : mock

appserver_custom_deploy_path              : "{{ install_dir|default('') }}"
appserver_config_path                     : "{{ appserver_custom_deploy_path }}/opt/appserver/conf"
appserver_nginx_access_logs               : /var/log/nginx-access.log
appserver_nginx_auth_basic_file           : htpassword

docker_registry:
  frontend                                : 239773179616.dkr.ecr.eu-west-1.amazonaws.com/appserver-frontend/ci:{{appserver_version}}
  backend                                 : 239773179616.dkr.ecr.eu-west-1.amazonaws.com/appserver-backend/ci:{{appserver_version}}
  registry_aws                            : True
~~~

Nginx is installed with a htpassword file. To define credentials must be in a encrypted file by ansible-vault.
Nginx password variable actually is a bcrypt encryption of the password that is generated by the command htpasswd.

#########################
# Credentials APPSERVER #
#########################
# Resultado de  htpasswd  -nb   user1 pass1 | sed -e 's/.*://'
# Resultado de  htpasswd  -nb   user2 pass2 | sed -e 's/.*://'

~~~
appserver_users:
  - name           : user1
    password       : $apr1$dPsrKxcT$qtu5s8dzdz995tZZbTYOH1
  - name           : user2
    password       : $apr1$Dj0B0E8n$7u/H2qgX5SF12RCJkq1Vr0

~~~

License
-------

BSD
